# 恢复按钮位置调整

## 修改内容

### 1. 界面调整

**登录界面**：
- ✅ 保留"恢复数据"按钮
- 位置：注册新账号 → **恢复数据** → 忘记密码/重置

**登录后的密码管理界面**：
- ❌ 移除"恢复数据"按钮
- 工具栏按钮：备份数据 → 添加密码 → 退出登录

### 2. 功能流程

#### 从登录界面点击"恢复数据"

```
用户点击"恢复数据"
  ↓
显示提示对话框
  • 说明恢复功能
  • 提示需要先登录
  • 询问是否继续
  ↓
用户点击"我知道了"
  ↓
设置标志 shouldShowRestoreAfterLogin = true
  ↓
用户登录账户
  ↓
登录成功后自动打开恢复对话框
  ↓
用户选择备份文件
  ↓
恢复数据完成
```

#### 提示对话框内容

```
━━━━━━━━━━━━━━━━━━━━━━━━━━
       📥 恢复数据说明
━━━━━━━━━━━━━━━━━━━━━━━━━━
• 从备份文件恢复密码数据
• 备份文件中的密码已加密
• 数据将追加到您的账户中
• 不会覆盖或删除现有数据
━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️ 恢复数据需要先登录账户
━━━━━━━━━━━━━━━━━━━━━━━━━━
请先登录您的账户，登录后系统会
自动打开恢复对话框
━━━━━━━━━━━━━━━━━━━━━━━━━━
   [我知道了]     [取消]
```

### 3. 代码变更

#### 新增全局变量
```go
var (
    // ... 其他变量
    
    // 标志：登录后是否自动打开恢复对话框
    shouldShowRestoreAfterLogin bool
)
```

#### 新增函数
```go
// showRestoreDialogBeforeLogin 登录前显示恢复对话框
func showRestoreDialogBeforeLogin()
```

#### 修改登录逻辑
登录成功后检查标志：
```go
if shouldShowRestoreAfterLogin {
    shouldShowRestoreAfterLogin = false
    showVaultScreen()
    // 延迟 500ms 打开恢复对话框
    time.AfterFunc(500*time.Millisecond, func() {
        showRestoreDialog()
    })
}
```

#### 移除登录后界面的恢复按钮
工具栏从：
- 备份数据 → **恢复数据** → 添加密码 → 退出登录

改为：
- 备份数据 → 添加密码 → 退出登录

### 4. 用户体验优化

#### 优点
1. **引导式体验**
   - 登录前点击"恢复数据"会有清晰的提示
   - 登录后自动打开恢复对话框，无需再次寻找按钮

2. **界面简洁**
   - 登录后工具栏按钮更少，更简洁
   - 减少了按钮数量，降低混乱感

3. **逻辑清晰**
   - 恢复功能需要登录，这一点在登录前就明确告知
   - 用户知道需要做什么，流程清晰

#### 使用流程
```
场景1：用户想恢复备份
  1. 打开应用（登录界面）
  2. 点击"恢复数据"按钮
  3. 看到提示，点击"我知道了"
  4. 输入用户名和OTP登录
  5. 登录成功，自动弹出恢复对话框
  6. 选择备份文件
  7. 恢复完成

场景2：用户先登录，后想恢复
  1. 打开应用（登录界面）
  2. 直接登录
  3. 需要恢复时...
  
  等等，这个场景有问题！
  登录后没有恢复按钮了！
```

### 5. ⚠️ 问题发现

当前实现有一个问题：
- 如果用户先登录，登录后想恢复数据
- 但登录后界面没有"恢复数据"按钮
- 用户需要退出登录，回到登录界面，点击"恢复数据"，再重新登录

这个流程不太友好！

### 6. 建议改进

#### 方案A：保留两处按钮（推荐）
- 登录界面：有"恢复数据"按钮（点击提示需要登录）
- 登录后界面：也有"恢复数据"按钮（直接执行恢复）

#### 方案B：只在登录界面（当前实现）
- 优点：界面简洁
- 缺点：登录后想恢复很麻烦

#### 方案C：只在登录后界面
- 登录界面：移除"恢复数据"按钮
- 登录后界面：保留"恢复数据"按钮
- 优点：逻辑清晰（需要登录才能恢复）
- 缺点：用户不知道有恢复功能

## 当前状态

✅ 已实现：
- 登录界面有"恢复数据"按钮
- 点击后提示需要登录
- 登录后自动打开恢复对话框
- 登录后界面无"恢复数据"按钮

⚠️ 潜在问题：
- 登录后无法主动触发恢复功能
- 必须退出登录才能恢复

💡 建议：
- 考虑在登录后界面也添加"恢复数据"按钮
- 或者在设置/菜单中提供恢复功能的入口
